/* mobilecaddy-utils - v2.0.1 - Bundle Time: 2018-11-29 10:57:03 */
/* git info: "2018-11-23 16:02:33 +0000": f458f3fe3659eef32ccde089f82b18d5376b87d6 (msd-628/p2m-fileUtils) */
/* Copyright 2018 MobileCaddy Ltd */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCurrentValueFromAppSoup=getCurrentValueFromAppSoup,exports.getCachedCurrentValueFromAppSoup=getCachedCurrentValueFromAppSoup,exports.updateNewValueInAppSoup=updateNewValueInAppSoup,exports.updateCurrentValueInAppSoup=updateCurrentValueInAppSoup;var smartStoreUtils=_interopRequireWildcard(require("./smartStoreUtils")),mobileCaddy=_interopRequireWildcard(require("./constants"));function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var u=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};u.get||u.set?Object.defineProperty(r,t,u):r[t]=e[t]}return r.default=e,r}var smartstore=cordova.require("com.salesforce.plugin.smartstore");function getCachedCurrentValueFromAppSoup(e){var r=localStorage.getItem("appSoup-"+e);return new Promise(function(t,u){r?t(r):getCurrentValueFromAppSoup(e).then(function(r){localStorage.setItem("appSoup-"+e,r),t(r)})})}function getCurrentValueFromAppSoup(e){return new Promise(function(r,t){var u=smartstore.buildExactQuerySpec("Name",e,mobileCaddy.QUERY_BUFFER_SIZE);smartStoreUtils.querySoupRecordsWithQuerySpec("appSoup",u,function(e){e[0]?r(e[0].CurrentValue):r(e[0])},function(e){t(e)})})}function updateValueInAppSoup(e,r,t){return new Promise(function(u,p){var o=smartstore.buildExactQuerySpec("Name",e,mobileCaddy.QUERY_BUFFER_SIZE);smartStoreUtils.querySoupRecordsWithQuerySpec("appSoup",o,function(e){e.length>0?(e[0][t]=r,smartstore.upsertSoupEntries("appSoup",e,function(e){u(e)},function(e){p(e)})):u()},function(e){p(e)})})}function updateNewValueInAppSoup(e,r){return updateValueInAppSoup(e,r,"NewValue")}function updateCurrentValueInAppSoup(e,r){return updateValueInAppSoup(e,r,"CurrentValue")}